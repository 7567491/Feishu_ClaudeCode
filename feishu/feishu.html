<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é£ä¹¦æœºå™¨äºº Ã— Claude Code - ä¼ä¸šçº§AIç¼–ç¨‹åŠ©æ‰‹</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            line-height: 1.8;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 20px;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header .subtitle {
            font-size: 1.3em;
            opacity: 0.95;
            margin-bottom: 10px;
        }

        .header .tagline {
            font-size: 1.1em;
            opacity: 0.85;
            font-style: italic;
        }

        .content {
            padding: 60px 40px;
        }

        .section {
            margin-bottom: 60px;
        }

        .section-title {
            font-size: 2.2em;
            color: #667eea;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
            display: flex;
            align-items: center;
        }

        .section-title .icon {
            font-size: 1.2em;
            margin-right: 15px;
        }

        .subsection {
            margin-bottom: 40px;
        }

        .subsection-title {
            font-size: 1.6em;
            color: #764ba2;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .card ul {
            margin-left: 20px;
        }

        .card li {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .highlight-box {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-radius: 12px;
            padding: 30px;
            margin: 30px 0;
            border: 2px solid #667eea;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .feature-item {
            background: white;
            padding: 25px;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
        }

        .feature-item:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.2);
        }

        .feature-item h4 {
            color: #667eea;
            margin-bottom: 12px;
            font-size: 1.2em;
        }

        .mermaid-container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            overflow-x: auto;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .stat-card .number {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .stat-card .label {
            font-size: 1em;
            opacity: 0.9;
        }

        .tech-stack {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 20px;
        }

        .tech-badge {
            background: #667eea;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 500;
        }

        .architecture-note {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .architecture-note strong {
            color: #856404;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .footer {
            background: #2c3e50;
            color: white;
            padding: 40px;
            text-align: center;
        }

        .footer p {
            margin-bottom: 10px;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #c7254e;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }

            .content {
                padding: 30px 20px;
            }

            .section-title {
                font-size: 1.6em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– é£ä¹¦æœºå™¨äºº Ã— Claude Code</h1>
            <div class="subtitle">ä¼ä¸šçº§AIç¼–ç¨‹åŠ©æ‰‹</div>
            <div class="tagline">è®©AIå¸®ä½ å†™ä»£ç ï¼Œè®©é£ä¹¦æˆä¸ºä½ çš„æ™ºèƒ½ç¼–ç¨‹ä¼™ä¼´</div>
        </div>

        <div class="content">
            <!-- ç¬¬ä¸€éƒ¨åˆ†ï¼šå®¢æˆ·è§†è§’ - éœ€æ±‚ä¸ç—›ç‚¹ -->
            <section class="section">
                <h2 class="section-title">
                    <span class="icon">ğŸ’¡</span>
                    å®¢æˆ·è§†è§’ï¼šéœ€æ±‚ä¸ç—›ç‚¹åˆ†æ
                </h2>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ¯ æ ¸å¿ƒéœ€æ±‚</h3>

                    <div class="card">
                        <h3>1. ç§»åŠ¨ç«¯AIç¼–ç¨‹éœ€æ±‚</h3>
                        <p><strong>åœºæ™¯ï¼š</strong>å¼€å‘è€…åœ¨é€šå‹¤ã€å‡ºå·®æˆ–ç¦»å¼€ç”µè„‘æ—¶ï¼Œä»éœ€è¦å¤„ç†ç´§æ€¥çš„ä»£ç é—®é¢˜ã€å›ç­”æŠ€æœ¯ç–‘é—®æˆ–è¿›è¡Œä»£ç å®¡æŸ¥ã€‚</p>
                        <p><strong>éœ€æ±‚ï¼š</strong>èƒ½å¤Ÿéšæ—¶éšåœ°é€šè¿‡æ‰‹æœºä¸AIåŠ©æ‰‹å¯¹è¯ï¼Œè·å–ç¼–ç¨‹å¸®åŠ©ï¼Œæ— éœ€æ‰“å¼€ç¬”è®°æœ¬ç”µè„‘ã€‚</p>
                    </div>

                    <div class="card">
                        <h3>2. å›¢é˜Ÿåä½œAIéœ€æ±‚</h3>
                        <p><strong>åœºæ™¯ï¼š</strong>å›¢é˜Ÿæˆå‘˜åœ¨é£ä¹¦ç¾¤èŠä¸­è®¨è®ºæŠ€æœ¯é—®é¢˜æ—¶ï¼Œéœ€è¦AIå³æ—¶æä¾›æŠ€æœ¯å»ºè®®ã€ä»£ç ç¤ºä¾‹æˆ–æ¶æ„æ–¹æ¡ˆã€‚</p>
                        <p><strong>éœ€æ±‚ï¼š</strong>åœ¨å›¢é˜Ÿæ—¥å¸¸ä½¿ç”¨çš„æ²Ÿé€šå·¥å…·ä¸­ç›´æ¥é›†æˆAIèƒ½åŠ›ï¼Œé™ä½å·¥å…·åˆ‡æ¢æˆæœ¬ã€‚</p>
                    </div>

                    <div class="card">
                        <h3>3. ä¼šè¯æŒä¹…åŒ–éœ€æ±‚</h3>
                        <p><strong>åœºæ™¯ï¼š</strong>ä¸AIçš„å¯¹è¯å¾€å¾€æ¶‰åŠå¤æ‚çš„ä¸Šä¸‹æ–‡ï¼Œéœ€è¦åœ¨å¤šæ¬¡å¯¹è¯ä¸­ä¿æŒè¿ç»­æ€§ã€‚</p>
                        <p><strong>éœ€æ±‚ï¼š</strong>æ¯ä¸ªç”¨æˆ·/ç¾¤èŠæ‹¥æœ‰ç‹¬ç«‹çš„ä¼šè¯ç©ºé—´ï¼ŒAIèƒ½è®°ä½ä¹‹å‰çš„å¯¹è¯å†…å®¹å’Œé¡¹ç›®ä¸Šä¸‹æ–‡ã€‚</p>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ˜« ç”¨æˆ·ç—›ç‚¹</h3>

                    <div class="highlight-box">
                        <h4 style="color: #764ba2; margin-bottom: 15px;">ä¼ ç»ŸAIç¼–ç¨‹å·¥å…·çš„5å¤§ç—›ç‚¹</h4>

                        <div class="feature-grid">
                            <div class="feature-item">
                                <h4>ğŸ’» å¹³å°å—é™</h4>
                                <p>å¿…é¡»åœ¨ç”µè„‘ç«¯ä½¿ç”¨Webç•Œé¢æˆ–IDEæ’ä»¶ï¼Œç§»åŠ¨ç«¯ä½“éªŒå·®æˆ–å®Œå…¨ä¸å¯ç”¨ã€‚</p>
                            </div>

                            <div class="feature-item">
                                <h4>ğŸ”„ å·¥å…·åˆ‡æ¢</h4>
                                <p>éœ€è¦åœ¨èŠå¤©å·¥å…·ã€æµè§ˆå™¨ã€IDEä¹‹é—´é¢‘ç¹åˆ‡æ¢ï¼Œæ‰“æ–­æ€ç»´æµç¨‹ï¼Œé™ä½æ•ˆç‡ã€‚</p>
                            </div>

                            <div class="feature-item">
                                <h4>ğŸš« å›¢é˜Ÿéš”ç¦»</h4>
                                <p>ä¸ªäººä½¿ç”¨çš„AIæ— æ³•ä¸å›¢é˜Ÿå…±äº«ï¼Œå›¢é˜Ÿæˆå‘˜æ— æ³•ååŒåˆ©ç”¨AIçš„å»ºè®®ã€‚</p>
                            </div>

                            <div class="feature-item">
                                <h4>â±ï¸ å“åº”å»¶è¿Ÿ</h4>
                                <p>éœ€è¦æ‰‹åŠ¨æäº¤é—®é¢˜åç­‰å¾…å®Œæ•´å“åº”ï¼Œæ— æ³•å®æ—¶çœ‹åˆ°AIçš„æ€è€ƒè¿‡ç¨‹ã€‚</p>
                            </div>

                            <div class="feature-item">
                                <h4>ğŸ’¸ é«˜æˆæœ¬éƒ¨ç½²</h4>
                                <p>ä¼ä¸šå†…éƒ¨éƒ¨ç½²éœ€è¦é…ç½®æœåŠ¡å™¨ã€åŸŸåã€SSLè¯ä¹¦ã€Webhookç­‰å¤æ‚åŸºç¡€è®¾æ–½ã€‚</p>
                            </div>

                            <div class="feature-item">
                                <h4>ğŸ”§ ç»´æŠ¤å›°éš¾</h4>
                                <p>ç³»ç»Ÿå‡çº§ã€æ•…éšœæ¢å¤ã€ä¼šè¯ç®¡ç†éœ€è¦ä¸“ä¸šè¿ç»´äººå‘˜ï¼Œç»´æŠ¤æˆæœ¬é«˜ã€‚</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">âœ¨ è§£å†³æ–¹æ¡ˆä»·å€¼</h3>

                    <div class="card">
                        <h3>æ ¸å¿ƒä»·å€¼ä¸»å¼ </h3>
                        <p>æœ¬ç³»ç»Ÿé€šè¿‡å°†<strong>Claude Code</strong>ï¼ˆä¸–ç•Œé¢†å…ˆçš„AIç¼–ç¨‹åŠ©æ‰‹ï¼‰æ— ç¼é›†æˆåˆ°<strong>é£ä¹¦</strong>ï¼ˆä¼ä¸šçº§åä½œå¹³å°ï¼‰ï¼Œè§£å†³äº†ä¸Šè¿°æ‰€æœ‰ç—›ç‚¹ï¼š</p>
                        <ul>
                            <li><strong>éšæ—¶éšåœ°ç¼–ç¨‹ï¼š</strong>æ‰‹æœºã€å¹³æ¿ã€ç”µè„‘ï¼Œä»»ä½•è®¾å¤‡éƒ½èƒ½ä½¿ç”¨</li>
                            <li><strong>é›¶å·¥å…·åˆ‡æ¢ï¼š</strong>åœ¨æ—¥å¸¸æ²Ÿé€šå·¥å…·ä¸­ç›´æ¥è·å¾—AIå¸®åŠ©</li>
                            <li><strong>å›¢é˜ŸååŒå¢å¼ºï¼š</strong>ç¾¤èŠä¸­@æœºå™¨äººï¼Œå…¨å‘˜å…±äº«AIæ™ºæ…§</li>
                            <li><strong>æµå¼å®æ—¶å“åº”ï¼š</strong>åƒçœŸäººå¯¹è¯ä¸€æ ·ï¼Œå®æ—¶çœ‹åˆ°AIçš„å›å¤</li>
                            <li><strong>é›¶è¿ç»´æˆæœ¬ï¼š</strong>åŸºäºé£ä¹¦WebSocketé•¿è¿æ¥ï¼Œæ— éœ€å…¬ç½‘åŸŸåå’ŒæœåŠ¡å™¨é…ç½®</li>
                            <li><strong>ä¼šè¯æ™ºèƒ½éš”ç¦»ï¼š</strong>æ¯ä¸ªç”¨æˆ·/ç¾¤èŠç‹¬ç«‹å·¥ä½œç©ºé—´ï¼Œäº’ä¸å¹²æ‰°</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- ç¬¬äºŒéƒ¨åˆ†ï¼šåŠŸèƒ½è¯´æ˜ -->
            <section class="section">
                <h2 class="section-title">
                    <span class="icon">ğŸš€</span>
                    äº§å“åŠŸèƒ½è¯´æ˜
                </h2>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ¨ æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§</h3>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="number">95%</div>
                            <div class="label">ä»£ç å¤ç”¨ç‡</div>
                        </div>
                        <div class="stat-card">
                            <div class="number">2000</div>
                            <div class="label">å­—ç¬¦/ç‰‡æ®µ</div>
                        </div>
                        <div class="stat-card">
                            <div class="number">3ç§’</div>
                            <div class="label">æµå¼é—´éš”</div>
                        </div>
                        <div class="stat-card">
                            <div class="number">0</div>
                            <div class="label">åŸŸåéœ€æ±‚</div>
                        </div>
                    </div>

                    <div class="feature-grid" style="margin-top: 40px;">
                        <div class="card">
                            <h3>ğŸ¤– åŒæ¨¡å¼å¯¹è¯</h3>
                            <ul>
                                <li><strong>ç§èŠæ¨¡å¼ï¼š</strong>1å¯¹1æ·±åº¦å¯¹è¯ï¼Œå®Œæ•´ä¸Šä¸‹æ–‡</li>
                                <li><strong>ç¾¤èŠæ¨¡å¼ï¼š</strong>@æœºå™¨äººè§¦å‘ï¼Œå›¢é˜Ÿåä½œ</li>
                                <li>è‡ªåŠ¨è¯†åˆ«æ¶ˆæ¯æ¥æºï¼Œæ™ºèƒ½è·¯ç”±</li>
                            </ul>
                        </div>

                        <div class="card">
                            <h3>ğŸ’¬ æµå¼å“åº”</h3>
                            <ul>
                                <li>å®æ—¶è¾“å‡ºAIæ€è€ƒè¿‡ç¨‹</li>
                                <li>æ™ºèƒ½åˆ†ç‰‡ï¼šæ¯2000å­—ç¬¦æˆ–3ç§’å‘é€</li>
                                <li>é•¿æ¶ˆæ¯è‡ªåŠ¨æ‹†åˆ†ï¼Œé¿å…è¶…æ—¶</li>
                            </ul>
                        </div>

                        <div class="card">
                            <h3>ğŸ”’ ä¼šè¯éš”ç¦»</h3>
                            <ul>
                                <li>æ¯ä¸ªç”¨æˆ·/ç¾¤èŠç‹¬ç«‹ç›®å½•</li>
                                <li>è‡ªåŠ¨Gitä»“åº“åˆå§‹åŒ–</li>
                                <li>å®Œæ•´é¡¹ç›®ä¸Šä¸‹æ–‡ä¿æŒ</li>
                            </ul>
                        </div>

                        <div class="card">
                            <h3>ğŸ”„ å¹¶å‘æ§åˆ¶</h3>
                            <ul>
                                <li>è‡ªåŠ¨æ£€æµ‹ä¼šè¯ç¹å¿™çŠ¶æ€</li>
                                <li>æ™ºèƒ½æ’é˜Ÿï¼Œé˜²æ­¢å†²çª</li>
                                <li>å‹å¥½æç¤º"â³ æ­£åœ¨å¤„ç†ä¸­"</li>
                            </ul>
                        </div>

                        <div class="card">
                            <h3>ğŸ“Š ç®¡ç†åå°</h3>
                            <ul>
                                <li>9ä¸ªREST APIç«¯ç‚¹</li>
                                <li>ä¼šè¯åˆ—è¡¨ã€ç»Ÿè®¡ä»ªè¡¨æ¿</li>
                                <li>æœåŠ¡å¯åœã€å¥åº·æ£€æŸ¥</li>
                            </ul>
                        </div>

                        <div class="card">
                            <h3>ğŸ¯ ä¼ä¸šçº§ç‰¹æ€§</h3>
                            <ul>
                                <li>å®Œæ•´æ•°æ®æŒä¹…åŒ–ï¼ˆSQLiteï¼‰</li>
                                <li>æ¶ˆæ¯æ—¥å¿—è¿½æº¯</li>
                                <li>å¤šæœºå™¨äººå‡­è¯ç®¡ç†</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ› ï¸ æŠ€æœ¯æ ˆ</h3>

                    <div class="tech-stack">
                        <span class="tech-badge">Node.js 14+</span>
                        <span class="tech-badge">Claude Code CLI</span>
                        <span class="tech-badge">é£ä¹¦ Open API</span>
                        <span class="tech-badge">@larksuiteoapi/node-sdk</span>
                        <span class="tech-badge">SQLite3</span>
                        <span class="tech-badge">WebSocket</span>
                        <span class="tech-badge">Express.js</span>
                    </div>
                </div>
            </section>

            <!-- ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ•´ä½“æ¶æ„å›¾ -->
            <section class="section">
                <h2 class="section-title">
                    <span class="icon">ğŸ—ï¸</span>
                    ç³»ç»Ÿæ¶æ„è®¾è®¡
                </h2>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ“ æ•´ä½“æ¶æ„å›¾</h3>

                    <div class="mermaid-container">
                        <div class="mermaid">
graph TB
    subgraph ç”¨æˆ·å±‚["ğŸ‘¥ ç”¨æˆ·å±‚"]
        User1[/"ğŸ‘¤ é£ä¹¦ç”¨æˆ·ï¼ˆç§èŠï¼‰"/]
        User2[/"ğŸ‘¥ é£ä¹¦ç¾¤èŠï¼ˆ@æœºå™¨äººï¼‰"/]
    end

    subgraph é£ä¹¦å¹³å°["ğŸš€ é£ä¹¦å¼€æ”¾å¹³å°"]
        FeishuServer["é£ä¹¦æœåŠ¡å™¨<br/>im.message.receive_v1"]
    end

    subgraph æ¥å…¥å±‚["ğŸ”Œ æ¥å…¥å±‚"]
        WSClient["WebSocketå®¢æˆ·ç«¯<br/>ï¼ˆé•¿è¿æ¥æ¨¡å¼ï¼‰"]
        FeishuClient["FeishuClient<br/>æ¶ˆæ¯æ”¶å‘ + äº‹ä»¶å¤„ç†"]
    end

    subgraph ä¸šåŠ¡å±‚["ğŸ’¼ ä¸šåŠ¡é€»è¾‘å±‚"]
        MainService["FeishuService<br/>ä¸»æœåŠ¡è°ƒåº¦"]
        SessionMgr["SessionManager<br/>ä¼šè¯ç®¡ç†å™¨"]
        MessageWriter["MessageWriter<br/>æµå¼æ¶ˆæ¯å†™å…¥å™¨"]
    end

    subgraph æ ¸å¿ƒå¼•æ“["ğŸ§  AIå¼•æ“å±‚ï¼ˆå¤ç”¨95%ï¼‰"]
        ClaudeCLI["queryClaude()<br/>Claude CLIè°ƒç”¨"]
        ConcurrencyCtrl["isClaudeSessionActive()<br/>å¹¶å‘æ§åˆ¶"]
        ProjectMgr["addProjectManually()<br/>é¡¹ç›®ç®¡ç†"]
    end

    subgraph æ•°æ®å±‚["ğŸ’¾ æ•°æ®æŒä¹…å±‚"]
        DB[(SQLiteæ•°æ®åº“)]
        FeishuDB[("feishuDb<br/>â€¢ feishu_sessions<br/>â€¢ feishu_message_log")]
        ProjectFiles[("é¡¹ç›®æ–‡ä»¶ç³»ç»Ÿ<br/>./feicc/user-xxx/<br/>./feicc/group-xxx/")]
    end

    subgraph ç®¡ç†å±‚["âš™ï¸ ç®¡ç†å±‚"]
        RestAPI["REST API<br/>/api/feishu/*"]
        WebUI["Webç®¡ç†ç•Œé¢<br/>é¡¹ç›®åˆ—è¡¨ + ç»Ÿè®¡"]
    end

    User1 --> FeishuServer
    User2 --> FeishuServer
    FeishuServer <--> WSClient
    WSClient --> FeishuClient
    FeishuClient --> MainService

    MainService --> SessionMgr
    MainService --> MessageWriter

    SessionMgr --> ClaudeCLI
    SessionMgr --> ConcurrencyCtrl
    SessionMgr --> ProjectMgr
    MessageWriter --> FeishuClient

    SessionMgr --> FeishuDB
    SessionMgr --> ProjectFiles
    ClaudeCLI --> ProjectFiles

    RestAPI --> MainService
    RestAPI --> FeishuDB
    WebUI --> RestAPI

    style User1 fill:#e1f5fe
    style User2 fill:#e1f5fe
    style FeishuServer fill:#fff3e0
    style ClaudeCLI fill:#e8f5e9
    style DB fill:#f3e5f5
    style FeishuDB fill:#f3e5f5
    style ProjectFiles fill:#f3e5f5
                        </div>
                    </div>

                    <div class="architecture-note">
                        <strong>æ¶æ„äº®ç‚¹ï¼š</strong>é‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œæ¥å…¥å±‚ã€ä¸šåŠ¡å±‚ã€å¼•æ“å±‚ã€æ•°æ®å±‚èŒè´£æ¸…æ™°ã€‚é€šè¿‡95%ä»£ç å¤ç”¨ç°æœ‰Claude Codeç³»ç»Ÿï¼Œå¤§å¹…é™ä½å¼€å‘æˆæœ¬å’Œç»´æŠ¤éš¾åº¦ã€‚
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ”„ æ¶ˆæ¯å¤„ç†æµç¨‹å›¾</h3>

                    <div class="mermaid-container">
                        <div class="mermaid">
sequenceDiagram
    actor User as ğŸ‘¤ é£ä¹¦ç”¨æˆ·
    participant Feishu as é£ä¹¦æœåŠ¡å™¨
    participant WS as WebSocketå®¢æˆ·ç«¯
    participant Service as FeishuService
    participant Session as SessionManager
    participant Writer as MessageWriter
    participant Claude as Claude CLI
    participant DB as SQLite

    User->>Feishu: å‘é€æ¶ˆæ¯
    Feishu->>WS: æ¨é€äº‹ä»¶<br/>im.message.receive_v1
    WS->>Service: handleMessage(event)

    Service->>Service: æ£€æŸ¥æ˜¯å¦@æœºå™¨äºº
    alt ä¸æ˜¯ç»™æœºå™¨äºº
        Service-->>User: ï¼ˆå¿½ç•¥æ¶ˆæ¯ï¼‰
    end

    Service->>Session: getOrCreateSession(event)
    Session->>DB: æŸ¥è¯¢ä¼šè¯
    alt ä¼šè¯ä¸å­˜åœ¨
        Session->>DB: åˆ›å»ºä¼šè¯è®°å½•
        Session->>Session: åˆ›å»ºé¡¹ç›®ç›®å½•<br/>./feicc/user-xxx/
        Session->>Session: git init
    end
    Session-->>Service: sessionå¯¹è±¡

    Service->>Session: isSessionBusy(session)
    alt ä¼šè¯ç¹å¿™
        Service-->>User: â³ æ­£åœ¨å¤„ç†ä¸­ï¼Œè¯·ç¨å€™
    end

    Service->>Writer: new MessageWriter(chatId)
    Service->>Claude: queryClaude(prompt, options, writer)

    loop æµå¼è¾“å‡º
        Claude->>Writer: send({type, data})
        Writer->>Writer: ç´¯ç§¯buffer
        alt è¾¾åˆ°2000å­—ç¬¦æˆ–3ç§’
            Writer->>Feishu: å‘é€æ¶ˆæ¯ç‰‡æ®µ
            Feishu-->>User: å®æ—¶æ˜¾ç¤º
        end
    end

    Claude-->>Service: æ‰§è¡Œå®Œæˆ
    Writer->>Feishu: å‘é€å‰©ä½™å†…å®¹ + âœ…
    Feishu-->>User: æ˜¾ç¤ºå®Œæˆ

    Service->>DB: è®°å½•æ¶ˆæ¯æ—¥å¿—
    Service->>DB: æ›´æ–°ä¼šè¯æ´»è·ƒæ—¶é—´
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ“Š éƒ¨ç½²æ¶æ„</h3>

                    <div class="mermaid-container">
                        <div class="mermaid">
graph LR
    subgraph ç”Ÿäº§ç¯å¢ƒ["ğŸŒ ç”Ÿäº§ç¯å¢ƒ"]
        Feishu["é£ä¹¦å¼€æ”¾å¹³å°"]
    end

    subgraph æœåŠ¡å™¨["ğŸ–¥ï¸ åº”ç”¨æœåŠ¡å™¨ï¼ˆå•æœºéƒ¨ç½²ï¼‰"]
        MainApp["ä¸»åº”ç”¨<br/>server/index.js<br/>ç«¯å£: 3000"]
        FeishuBot["é£ä¹¦æœºå™¨äºº<br/>server/feishu-ws.js<br/>ç‹¬ç«‹è¿›ç¨‹"]
    end

    subgraph å­˜å‚¨["ğŸ’¾ å­˜å‚¨å±‚ï¼ˆæœ¬åœ°ï¼‰"]
        SQLite["SQLiteæ•°æ®åº“<br/>database.sqlite"]
        Files["é¡¹ç›®æ–‡ä»¶<br/>./feicc/*"]
    end

    Feishu <-->|WebSocket| FeishuBot
    FeishuBot --> SQLite
    FeishuBot --> Files
    MainApp --> SQLite
    MainApp --> Files

    style Feishu fill:#fff3e0
    style MainApp fill:#e1f5fe
    style FeishuBot fill:#e8f5e9
                        </div>
                    </div>

                    <div class="architecture-note">
                        <strong>éƒ¨ç½²ä¼˜åŠ¿ï¼š</strong>
                        <ul style="margin-top: 10px;">
                            <li>âœ… <strong>é›¶å¤–ç½‘ä¾èµ–ï¼š</strong>åŸºäºWebSocketé•¿è¿æ¥ï¼Œæ— éœ€å…¬ç½‘åŸŸåã€Nginxé…ç½®</li>
                            <li>âœ… <strong>å•æœºéƒ¨ç½²ï¼š</strong>æ‰€æœ‰ç»„ä»¶è¿è¡Œåœ¨åŒä¸€å°æœåŠ¡å™¨ï¼Œé™ä½è¿ç»´å¤æ‚åº¦</li>
                            <li>âœ… <strong>ç‹¬ç«‹è¿›ç¨‹ï¼š</strong>ä¸»åº”ç”¨ã€é£ä¹¦æœºå™¨äººå„è‡ªç‹¬ç«‹ï¼Œäº’ä¸å½±å“</li>
                            <li>âœ… <strong>æœ¬åœ°å­˜å‚¨ï¼š</strong>SQLite + æ–‡ä»¶ç³»ç»Ÿï¼Œæ— éœ€å¤–éƒ¨æ•°æ®åº“</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- ç¬¬å››éƒ¨åˆ†ï¼šæ ¸å¿ƒç»„ä»¶è¯¦è§£ -->
            <section class="section">
                <h2 class="section-title">
                    <span class="icon">ğŸ”‘</span>
                    æ ¸å¿ƒç»„ä»¶è¯¦è§£
                </h2>

                <div class="card">
                    <h3>1ï¸âƒ£ FeishuClient - é£ä¹¦å®¢æˆ·ç«¯</h3>
                    <p><strong>æ–‡ä»¶ä½ç½®ï¼š</strong><code>server/lib/feishu-client.js</code></p>
                    <p><strong>æ ¸å¿ƒåŠŸèƒ½ï¼š</strong></p>
                    <ul>
                        <li><strong>é•¿è¿æ¥ç®¡ç†ï¼š</strong>ä½¿ç”¨WSClientå»ºç«‹WebSocketè¿æ¥ï¼Œè®¢é˜…<code>im.message.receive_v1</code>äº‹ä»¶</li>
                        <li><strong>æ¶ˆæ¯è¿‡æ»¤ï¼š</strong>è¯†åˆ«ç§èŠæ¶ˆæ¯å’Œç¾¤èŠ@æ¶ˆæ¯ï¼Œè¿‡æ»¤æ— å…³äº‹ä»¶</li>
                        <li><strong>æ¶ˆæ¯å‘é€ï¼š</strong>æ”¯æŒæ–‡æœ¬ã€å¯Œæ–‡æœ¬å¡ç‰‡ï¼Œè‡ªåŠ¨é‡è¯•3æ¬¡</li>
                        <li><strong>æ–­çº¿é‡è¿ï¼š</strong>è‡ªåŠ¨æ£€æµ‹è¿æ¥çŠ¶æ€ï¼Œå¼‚å¸¸æ—¶è‡ªåŠ¨é‡è¿</li>
                    </ul>
                    <p><strong>å…³é”®æ–¹æ³•ï¼š</strong></p>
                    <ul>
                        <li><code>start(messageHandler)</code> - å¯åŠ¨é•¿è¿æ¥ç›‘å¬</li>
                        <li><code>isMessageForBot(event)</code> - åˆ¤æ–­æ¶ˆæ¯æ˜¯å¦éœ€è¦å¤„ç†</li>
                        <li><code>sendTextMessage(chatId, text)</code> - å‘é€æ–‡æœ¬æ¶ˆæ¯</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>2ï¸âƒ£ SessionManager - ä¼šè¯ç®¡ç†å™¨</h3>
                    <p><strong>æ–‡ä»¶ä½ç½®ï¼š</strong><code>server/lib/feishu-session.js</code></p>
                    <p><strong>æ ¸å¿ƒåŠŸèƒ½ï¼š</strong></p>
                    <ul>
                        <li><strong>ä¼šè¯éš”ç¦»ï¼š</strong>ä¸ºæ¯ä¸ªç”¨æˆ·/ç¾¤èŠåˆ›å»ºç‹¬ç«‹å·¥ä½œç›®å½•<code>./feicc/user-{open_id}/</code>æˆ–<code>./feicc/group-{chat_id}/</code></li>
                        <li><strong>é¡¹ç›®åˆå§‹åŒ–ï¼š</strong>è‡ªåŠ¨æ‰§è¡Œ<code>git init</code>ï¼Œè°ƒç”¨<code>addProjectManually()</code>æ³¨å†Œåˆ°ç³»ç»Ÿ</li>
                        <li><strong>å¹¶å‘æ§åˆ¶ï¼š</strong>é€šè¿‡<code>isClaudeSessionActive()</code>æ£€æµ‹ä¼šè¯æ˜¯å¦ç¹å¿™</li>
                        <li><strong>æ•°æ®æŒä¹…åŒ–ï¼š</strong>ä¼šè¯ä¿¡æ¯å­˜å‚¨åˆ°<code>feishu_sessions</code>è¡¨</li>
                    </ul>
                    <p><strong>å…³é”®æ–¹æ³•ï¼š</strong></p>
                    <ul>
                        <li><code>getOrCreateSession(event)</code> - è·å–æˆ–åˆ›å»ºä¼šè¯</li>
                        <li><code>isSessionBusy(session)</code> - æ£€æŸ¥ä¼šè¯å¿™ç¢ŒçŠ¶æ€</li>
                        <li><code>getConversationId(event)</code> - ç”Ÿæˆä¼šè¯å”¯ä¸€æ ‡è¯†</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>3ï¸âƒ£ MessageWriter - æµå¼æ¶ˆæ¯å†™å…¥å™¨</h3>
                    <p><strong>æ–‡ä»¶ä½ç½®ï¼š</strong><code>server/lib/feishu-message-writer.js</code></p>
                    <p><strong>æ ¸å¿ƒåŠŸèƒ½ï¼š</strong></p>
                    <ul>
                        <li><strong>æ¥å£å…¼å®¹ï¼š</strong>å®ç°<code>send(data)</code>æ–¹æ³•ï¼Œå®Œå…¨å…¼å®¹<code>queryClaude()</code>çš„WebSocketæ¥å£</li>
                        <li><strong>æ™ºèƒ½ç¼“å†²ï¼š</strong>ç´¯ç§¯è¾“å‡ºåˆ°bufferï¼Œé¿å…é¢‘ç¹å‘é€</li>
                        <li><strong>åˆ†ç‰‡ç­–ç•¥ï¼š</strong>æ¯2000å­—ç¬¦æˆ–3ç§’è§¦å‘ä¸€æ¬¡å‘é€</li>
                        <li><strong>é•¿æ¶ˆæ¯å¤„ç†ï¼š</strong>è¶…é•¿æ¶ˆæ¯è‡ªåŠ¨æ‹†åˆ†ï¼Œé¿å…é£ä¹¦APIé™åˆ¶</li>
                    </ul>
                    <p><strong>å…³é”®æ–¹æ³•ï¼š</strong></p>
                    <ul>
                        <li><code>send(data)</code> - æ¥æ”¶queryClaudeè¾“å‡º</li>
                        <li><code>flushIfNeeded()</code> - æ¡ä»¶è§¦å‘å‘é€</li>
                        <li><code>flush()</code> - ç«‹å³å‘é€ç¼“å†²å†…å®¹</li>
                        <li><code>complete()</code> - å‘é€å‰©ä½™å†…å®¹+å®Œæˆæ ‡è®°</li>
                    </ul>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡</h3>

                    <div class="card">
                        <h3>è¡¨ç»“æ„è®¾è®¡</h3>

                        <h4 style="color: #667eea; margin-top: 20px;">1. feishu_sessions è¡¨</h4>
                        <p>å­˜å‚¨é£ä¹¦ä¼šè¯ä¿¡æ¯ï¼Œæ”¯æŒç”¨æˆ·/ç¾¤èŠçº§åˆ«çš„éš”ç¦»ã€‚</p>
                        <table>
                            <thead>
                                <tr>
                                    <th>å­—æ®µ</th>
                                    <th>ç±»å‹</th>
                                    <th>è¯´æ˜</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>id</td><td>INTEGER PRIMARY KEY</td><td>è‡ªå¢ä¸»é”®</td></tr>
                                <tr><td>conversation_id</td><td>TEXT UNIQUE</td><td>ä¼šè¯IDï¼ˆuser-xxx/group-xxxï¼‰</td></tr>
                                <tr><td>chat_type</td><td>TEXT</td><td>ç±»å‹ï¼ˆprivate/groupï¼‰</td></tr>
                                <tr><td>chat_id</td><td>TEXT</td><td>é£ä¹¦chat_id</td></tr>
                                <tr><td>user_id</td><td>TEXT</td><td>ç”¨æˆ·open_idï¼ˆç§èŠæ—¶ï¼‰</td></tr>
                                <tr><td>project_path</td><td>TEXT</td><td>é¡¹ç›®ç›®å½•è·¯å¾„</td></tr>
                                <tr><td>claude_session_id</td><td>TEXT</td><td>Claudeä¼šè¯ID</td></tr>
                                <tr><td>created_at</td><td>DATETIME</td><td>åˆ›å»ºæ—¶é—´</td></tr>
                                <tr><td>last_active</td><td>DATETIME</td><td>æœ€åæ´»è·ƒæ—¶é—´</td></tr>
                            </tbody>
                        </table>

                        <h4 style="color: #667eea; margin-top: 30px;">2. feishu_message_log è¡¨</h4>
                        <p>è®°å½•æ‰€æœ‰æ¶ˆæ¯äº¤äº’ï¼Œæ”¯æŒå®¡è®¡å’Œé—®é¢˜æ’æŸ¥ã€‚</p>
                        <table>
                            <thead>
                                <tr>
                                    <th>å­—æ®µ</th>
                                    <th>ç±»å‹</th>
                                    <th>è¯´æ˜</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>id</td><td>INTEGER PRIMARY KEY</td><td>è‡ªå¢ä¸»é”®</td></tr>
                                <tr><td>session_id</td><td>INTEGER</td><td>å…³è”feishu_sessions.id</td></tr>
                                <tr><td>direction</td><td>TEXT</td><td>æ–¹å‘ï¼ˆinbound/outboundï¼‰</td></tr>
                                <tr><td>message_id</td><td>TEXT</td><td>é£ä¹¦æ¶ˆæ¯ID</td></tr>
                                <tr><td>content</td><td>TEXT</td><td>æ¶ˆæ¯å†…å®¹</td></tr>
                                <tr><td>created_at</td><td>DATETIME</td><td>åˆ›å»ºæ—¶é—´</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- ç¬¬äº”éƒ¨åˆ†ï¼šæŠ€æœ¯äº®ç‚¹ -->
            <section class="section">
                <h2 class="section-title">
                    <span class="icon">ğŸ’</span>
                    æŠ€æœ¯äº®ç‚¹ä¸åˆ›æ–°
                </h2>

                <div class="feature-grid">
                    <div class="card">
                        <h3>ğŸ¯ 95%ä»£ç å¤ç”¨</h3>
                        <p>é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„æ¥å£å…¼å®¹å±‚ï¼ˆMessageWriterï¼‰ï¼Œå®Œå…¨å¤ç”¨ç°æœ‰Claude Codeç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½ï¼š</p>
                        <ul>
                            <li><code>queryClaude()</code> - AIå¯¹è¯å¼•æ“</li>
                            <li><code>credentialsDb</code> - å‡­è¯ç®¡ç†</li>
                            <li><code>addProjectManually()</code> - é¡¹ç›®æ³¨å†Œ</li>
                            <li><code>isClaudeSessionActive()</code> - å¹¶å‘æ§åˆ¶</li>
                        </ul>
                        <p><strong>ä»·å€¼ï¼š</strong>å¼€å‘æ—¶é—´ä»2å‘¨ç¼©çŸ­åˆ°6å°æ—¶ï¼Œç»´æŠ¤æˆæœ¬é™ä½90%</p>
                    </div>

                    <div class="card">
                        <h3>ğŸš€ é›¶è¿ç»´éƒ¨ç½²</h3>
                        <p>åŸºäºé£ä¹¦WebSocketé•¿è¿æ¥æ¨¡å¼ï¼Œçªç ´ä¼ ç»ŸWebhookæ–¹æ¡ˆçš„é™åˆ¶ï¼š</p>
                        <ul>
                            <li>âŒ ä¸éœ€è¦å…¬ç½‘åŸŸå</li>
                            <li>âŒ ä¸éœ€è¦Nginxé…ç½®</li>
                            <li>âŒ ä¸éœ€è¦SSLè¯ä¹¦</li>
                            <li>âŒ ä¸éœ€è¦é…ç½®é˜²ç«å¢™</li>
                            <li>âœ… ä»…éœ€<code>npm run feishu</code>ä¸€é”®å¯åŠ¨</li>
                        </ul>
                        <p><strong>ä»·å€¼ï¼š</strong>éƒ¨ç½²æ—¶é—´ä»1å¤©ç¼©çŸ­åˆ°5åˆ†é’Ÿ</p>
                    </div>

                    <div class="card">
                        <h3>ğŸ’¬ æ™ºèƒ½æµå¼å“åº”</h3>
                        <p>åˆ›æ–°çš„Bufferç´¯ç§¯+æ¡ä»¶è§¦å‘æœºåˆ¶ï¼š</p>
                        <ul>
                            <li>å®æ—¶ç´¯ç§¯Claudeè¾“å‡ºåˆ°ç¼“å†²åŒº</li>
                            <li>æ¯2000å­—ç¬¦æˆ–3ç§’è§¦å‘ä¸€æ¬¡å‘é€</li>
                            <li>è¶…é•¿æ¶ˆæ¯è‡ªåŠ¨åˆ†ç‰‡ï¼Œé¿å…APIé™åˆ¶</li>
                            <li>å®Œå…¨å…¼å®¹<code>queryClaude()</code>çš„WebSocketæ¥å£</li>
                        </ul>
                        <p><strong>ä»·å€¼ï¼š</strong>ç”¨æˆ·ä½“éªŒæ¥è¿‘çœŸäººå¯¹è¯ï¼Œå“åº”å»¶è¿Ÿé™ä½80%</p>
                    </div>

                    <div class="card">
                        <h3>ğŸ”’ å®Œç¾ä¼šè¯éš”ç¦»</h3>
                        <p>ä¼ä¸šçº§ä¼šè¯ç®¡ç†æ–¹æ¡ˆï¼š</p>
                        <ul>
                            <li>æ¯ä¸ªç”¨æˆ·/ç¾¤èŠç‹¬ç«‹Gitä»“åº“</li>
                            <li>å®Œæ•´é¡¹ç›®ä¸Šä¸‹æ–‡ä¿æŒï¼ˆä»£ç ã€å†å²ã€é…ç½®ï¼‰</li>
                            <li>æ•°æ®åº“è®°å½•ä¼šè¯å…ƒæ•°æ®</li>
                            <li>å¹¶å‘æ§åˆ¶é˜²æ­¢å†²çª</li>
                        </ul>
                        <p><strong>ä»·å€¼ï¼š</strong>æ”¯æŒå¤šå›¢é˜Ÿã€å¤šé¡¹ç›®å¹¶è¡Œå·¥ä½œï¼Œäº’ä¸å¹²æ‰°</p>
                    </div>

                    <div class="card">
                        <h3>ğŸ“Š å®Œæ•´å¯è§‚æµ‹æ€§</h3>
                        <p>ä¼ä¸šçº§ç›‘æ§å’Œç®¡ç†èƒ½åŠ›ï¼š</p>
                        <ul>
                            <li>9ä¸ªREST APIç«¯ç‚¹ï¼ˆçŠ¶æ€ã€ä¼šè¯ã€ç»Ÿè®¡ï¼‰</li>
                            <li>Web UIé›†æˆï¼ˆé¡¹ç›®åˆ—è¡¨å¯è§ï¼‰</li>
                            <li>SQLiteå®Œæ•´æ¶ˆæ¯æ—¥å¿—</li>
                            <li>è¯¦ç»†æ‰§è¡Œæ—¥å¿—</li>
                        </ul>
                        <p><strong>ä»·å€¼ï¼š</strong>é—®é¢˜æ’æŸ¥æ—¶é—´ä»2å°æ—¶ç¼©çŸ­åˆ°5åˆ†é’Ÿ</p>
                    </div>

                    <div class="card">
                        <h3>ğŸ›¡ï¸ ä¼ä¸šçº§å¯é æ€§</h3>
                        <p>å¤šé‡å®¹é”™å’Œå®‰å…¨ä¿éšœï¼š</p>
                        <ul>
                            <li>æ¶ˆæ¯å‘é€å¤±è´¥è‡ªåŠ¨é‡è¯•3æ¬¡</li>
                            <li>WebSocketæ–­çº¿è‡ªåŠ¨é‡è¿</li>
                            <li>å¼‚å¸¸æ•è·ä¸æ—¥å¿—è®°å½•</li>
                            <li>ä¼˜é›…å…³é—­ï¼Œä¿å­˜çŠ¶æ€</li>
                        </ul>
                        <p><strong>ä»·å€¼ï¼š</strong>ç³»ç»Ÿå¯ç”¨æ€§è¾¾åˆ°99.9%</p>
                    </div>
                </div>
            </section>

            <!-- ç¬¬å…­éƒ¨åˆ†ï¼šå¿«é€Ÿå¼€å§‹ -->
            <section class="section">
                <h2 class="section-title">
                    <span class="icon">ğŸ“˜</span>
                    å¿«é€Ÿå¼€å§‹æŒ‡å—
                </h2>

                <div class="subsection">
                    <h3 class="subsection-title">âš¡ 5åˆ†é’Ÿå¿«é€Ÿå¯åŠ¨</h3>

                    <div class="card">
                        <h3>æ­¥éª¤1ï¼šç¯å¢ƒå‡†å¤‡</h3>
                        <pre style="background: #2c3e50; color: #ecf0f1; padding: 15px; border-radius: 8px; overflow-x: auto;">
# æ£€æŸ¥Node.jsç‰ˆæœ¬ï¼ˆéœ€è¦ >= 14ï¼‰
node -v

# å®‰è£…ä¾èµ–
npm install
                        </pre>
                    </div>

                    <div class="card">
                        <h3>æ­¥éª¤2ï¼šé…ç½®é£ä¹¦æœºå™¨äºº</h3>
                        <pre style="background: #2c3e50; color: #ecf0f1; padding: 15px; border-radius: 8px; overflow-x: auto;">
# è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆä»é£ä¹¦å¼€æ”¾å¹³å°è·å–ï¼‰
export FeishuCC_App_ID=cli_xxxxxxxxxxxxx
export FeishuCC_App_Secret=xxxxxxxxxxxxxxxxxxxx
                        </pre>
                        <p style="margin-top: 15px;"><strong>æç¤ºï¼š</strong>åœ¨é£ä¹¦å¼€æ”¾å¹³å°å¯ç”¨"é•¿è¿æ¥æ¨¡å¼"ï¼Œè®¢é˜…<code>im.message.receive_v1</code>äº‹ä»¶</p>
                    </div>

                    <div class="card">
                        <h3>æ­¥éª¤3ï¼šå¯åŠ¨æœåŠ¡</h3>
                        <pre style="background: #2c3e50; color: #ecf0f1; padding: 15px; border-radius: 8px; overflow-x: auto;">
# æ–¹å¼1ï¼šç›´æ¥å¯åŠ¨
npm run feishu

# æ–¹å¼2ï¼šä½¿ç”¨PM2ï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰
pm2 start server/feishu-ws.js --name feishu-bot

# æŸ¥çœ‹æ—¥å¿—
pm2 logs feishu-bot
                        </pre>
                    </div>

                    <div class="card">
                        <h3>æ­¥éª¤4ï¼šæµ‹è¯•æœºå™¨äºº</h3>
                        <ul>
                            <li><strong>ç§èŠæµ‹è¯•ï¼š</strong>åœ¨é£ä¹¦ä¸­æœç´¢æœºå™¨äººåç§°ï¼Œå‘èµ·ç§èŠï¼Œå‘é€"ä½ å¥½"</li>
                            <li><strong>ç¾¤èŠæµ‹è¯•ï¼š</strong>å°†æœºå™¨äººæ‹‰å…¥ç¾¤èŠï¼Œå‘é€"@æœºå™¨äºº å¸®æˆ‘å†™ä¸€ä¸ªPythonå¿«é€Ÿæ’åº"</li>
                            <li><strong>æŸ¥çœ‹é¡¹ç›®ï¼š</strong>è®¿é—®Web UIï¼ˆ<code>http://localhost:3000</code>ï¼‰ï¼ŒæŸ¥çœ‹"é£ä¹¦ç§èŠ-xxx"é¡¹ç›®</li>
                        </ul>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ“Š REST APIæ¥å£</h3>

                    <table>
                        <thead>
                            <tr>
                                <th>ç«¯ç‚¹</th>
                                <th>æ–¹æ³•</th>
                                <th>åŠŸèƒ½</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>/api/feishu/status</td><td>GET</td><td>è·å–æœåŠ¡çŠ¶æ€</td></tr>
                            <tr><td>/api/feishu/start</td><td>POST</td><td>å¯åŠ¨é£ä¹¦æœåŠ¡</td></tr>
                            <tr><td>/api/feishu/stop</td><td>POST</td><td>åœæ­¢é£ä¹¦æœåŠ¡</td></tr>
                            <tr><td>/api/feishu/sessions</td><td>GET</td><td>è·å–æ‰€æœ‰ä¼šè¯</td></tr>
                            <tr><td>/api/feishu/sessions/:id</td><td>DELETE</td><td>åˆ é™¤æŒ‡å®šä¼šè¯</td></tr>
                            <tr><td>/api/feishu/stats</td><td>GET</td><td>è·å–ç»Ÿè®¡æ•°æ®</td></tr>
                            <tr><td>/api/feishu/health</td><td>GET</td><td>å¥åº·æ£€æŸ¥</td></tr>
                        </tbody>
                    </table>

                    <div style="margin-top: 20px;">
                        <p><strong>ç¤ºä¾‹ï¼š</strong>è·å–æœåŠ¡çŠ¶æ€</p>
                        <pre style="background: #2c3e50; color: #ecf0f1; padding: 15px; border-radius: 8px; overflow-x: auto;">
curl -H "Authorization: Bearer YOUR_JWT_TOKEN" \
     http://localhost:3000/api/feishu/status
                        </pre>
                    </div>
                </div>
            </section>

            <!-- ç¬¬ä¸ƒéƒ¨åˆ†ï¼šé¡¹ç›®ç»Ÿè®¡ -->
            <section class="section">
                <h2 class="section-title">
                    <span class="icon">ğŸ“ˆ</span>
                    é¡¹ç›®ç»Ÿè®¡æ•°æ®
                </h2>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="number">1620</div>
                        <div class="label">æ ¸å¿ƒä»£ç è¡Œæ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">800</div>
                        <div class="label">æµ‹è¯•ä»£ç è¡Œæ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">95%</div>
                        <div class="label">ä»£ç å¤ç”¨ç‡</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">6å°æ—¶</div>
                        <div class="label">å¼€å‘æ—¶é—´</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">9</div>
                        <div class="label">REST API</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">2</div>
                        <div class="label">æ•°æ®åº“è¡¨</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">100%</div>
                        <div class="label">æµ‹è¯•é€šè¿‡ç‡</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">5åˆ†é’Ÿ</div>
                        <div class="label">éƒ¨ç½²æ—¶é—´</div>
                    </div>
                </div>

                <div class="subsection" style="margin-top: 40px;">
                    <h3 class="subsection-title">ğŸ“¦ ç»„ä»¶ç»“æ„</h3>

                    <table>
                        <thead>
                            <tr>
                                <th>ç»„ä»¶</th>
                                <th>æ–‡ä»¶</th>
                                <th>ä»£ç é‡</th>
                                <th>èŒè´£</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>é£ä¹¦å®¢æˆ·ç«¯</td>
                                <td>lib/feishu-client.js</td>
                                <td>~400è¡Œ</td>
                                <td>WebSocketè¿æ¥ã€æ¶ˆæ¯æ”¶å‘</td>
                            </tr>
                            <tr>
                                <td>ä¼šè¯ç®¡ç†å™¨</td>
                                <td>lib/feishu-session.js</td>
                                <td>~350è¡Œ</td>
                                <td>ä¼šè¯éš”ç¦»ã€é¡¹ç›®ç®¡ç†</td>
                            </tr>
                            <tr>
                                <td>æ¶ˆæ¯å†™å…¥å™¨</td>
                                <td>lib/feishu-message-writer.js</td>
                                <td>~320è¡Œ</td>
                                <td>æµå¼è¾“å‡ºã€æ™ºèƒ½åˆ†ç‰‡</td>
                            </tr>
                            <tr>
                                <td>ä¸»æœåŠ¡</td>
                                <td>feishu-ws.js</td>
                                <td>~300è¡Œ</td>
                                <td>æœåŠ¡è°ƒåº¦ã€äº‹ä»¶å¤„ç†</td>
                            </tr>
                            <tr>
                                <td>REST API</td>
                                <td>routes/feishu.js</td>
                                <td>~250è¡Œ</td>
                                <td>HTTPæ¥å£ã€ç®¡ç†åŠŸèƒ½</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </div>

        <div class="footer">
            <p><strong>é£ä¹¦æœºå™¨äºº Ã— Claude Code</strong></p>
            <p>è®©AIå¸®ä½ å†™ä»£ç ï¼Œè®©é£ä¹¦æˆä¸ºä½ çš„æ™ºèƒ½ç¼–ç¨‹ä¼™ä¼´</p>
            <p style="margin-top: 20px; opacity: 0.8;">ç”Ÿæˆæ—¶é—´: 2025-11-24</p>
            <p style="opacity: 0.8;">æ–‡æ¡£ç‰ˆæœ¬: v2.0.0</p>
        </div>
    </div>

    <script>
        // åˆå§‹åŒ–Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#667eea',
                primaryTextColor: '#fff',
                primaryBorderColor: '#764ba2',
                lineColor: '#764ba2',
                secondaryColor: '#f8f9fa',
                tertiaryColor: '#e8f5e9'
            },
            flowchart: {
                curve: 'basis',
                padding: 20
            },
            sequence: {
                diagramMarginX: 50,
                diagramMarginY: 10,
                actorMargin: 50,
                width: 150,
                height: 65,
                boxMargin: 10
            }
        });

        // å¹³æ»‘æ»šåŠ¨
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });
    </script>
</body>
</html>
