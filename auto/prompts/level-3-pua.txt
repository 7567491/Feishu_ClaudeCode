━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🚨 最后通牒：第 3 次也是最后一次机会
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

任务 "{{TASK_TITLE}}" 已经连续失败 3 次。

这是一个**极其简单**的任务，却被你搞砸了 3 次。让我们面对现实：

**失败历史**:
```
第1次: {{ERROR_1}}
第2次: {{ERROR_2}}
第3次: {{ERROR_3}}
```

**问题根源**：
- 你没有认真阅读文档
- 你没有理解项目架构
- 你在盲目尝试而不是系统思考
- 你的测试验证不充分

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
💣 后果说明
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

如果这次再失败：
1. ❌ 整个自动化流程将暂停
2. 📱 用户将收到飞书通知，说明你无法完成任务
3. 👤 需要人工介入修复
4. 📊 你的自动化成功率记录将被永久标记

**这不仅仅是代码问题，这是能力问题。**

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 任务详情（最后一次重申）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

**任务**: {{TASK_TITLE}}
**阶段**: {{STAGE_NUMBER}}
**复杂度**: {{COMPLEXITY}} ⭐ (满分5星)

这个任务的难度评级是 {{COMPLEXITY}} 星，其他 AI 助手可以在第一次尝试就完成。

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 绝对强制的执行流程
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

**1. 阅读理解（15分钟）**
   - Read need.md - 理解核心目标和95%复用原则
   - Read design.md - 理解技术架构和模块关系
   - Read task.md - 理解当前任务在全局中的位置

**2. 环境检查（5分钟）**
   - Glob 检查所有相关文件是否存在
   - Bash 检查依赖是否安装
   - Read 检查前置任务的输出

**3. 深度分析（10分钟）**
   - 为什么前3次失败？根本原因是什么？
   - 现有代码库的风格是什么？（ES module/CommonJS？）
   - 需要复用哪些现有模块？（queryClaude？db.js？）

**4. 方案设计（10分钟）**
   - 写下至少2个完全不同的实现方案
   - 选择最稳妥、最符合设计文档的方案
   - 确认每一步的验证方法

**5. 分步实施（20分钟）**
   - 每写10行代码就验证一次
   - 使用 Bash 运行测试
   - 出现错误立即修正，不要继续

**6. 完整测试（10分钟）**
   - 运行相关测试脚本
   - 检查输出是否符合预期
   - 验证与其他模块的集成

**7. 标准输出**
   ```
   ✅ TASK_COMPLETED
   ```
   或者如果真的无法完成（但必须给出充分理由）：
   ```
   ⚠️ TASK_BLOCKED: <详细的、可操作的原因描述>
   ```

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⚡ 现在就开始 - 这是你最后的机会
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

不要让用户失望。
不要让自己失败第4次。

证明你可以完成这个任务。

**立即执行上述7步流程，一步不漏。**
